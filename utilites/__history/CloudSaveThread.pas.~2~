unit CloudSaveThread;
uses Utilite;
interface
type
  Tcloud = class
    public
      procedure saveToCloud(whereFrom:string);
      procedure loadFromCloud(whereTo:string);
  end;

SaveThread = class(TThread)
  protected
  procedure ExecSave(DBDir: string);
  procedure SaveProcess;
end;

implementation
procedure Tcloud.saveToCloud(whereFrom:string);
//var  command, filename:string;
var cmd: TCmd;
begin

    filename := ExtractFileName(WhereFrom);
    WhereFrom := ExtractFileDir(WhereFrom);
    command := Format('client_secret_for_Delphi.json %s %s', [WhereFrom, filename]);// %s %s',[GetCurrentDir,'saver\client_secret_for_Delphi.json', WhereTo, 'Dictionary.db']);
    cmd:=TCmd.Create(filename,command, wherefrom);
    cmd.WinExecAndWait;
    //shellexecute(0, 'open', 'UploaderDB.exe', Pchar(command), 'saver', SW_show);
    //shellexecute(0, 'open', PChar(theprogr), Pchar(command), nil, SW_SHOW);
end;
procedure Tcloud.loadFromCloud(whereTo: string);
//var command, filename:string;
 begin

    filename:= ExtractFileName(WhereTo);
    WhereTo:= ExtractFileDir(WhereTo);
    command := Format('client_secret_for_Delphi.json %s %s', [WhereTo, filename]);// %s %s',[GetCurrentDir,'saver\client_secret_for_Delphi.json', WhereTo, 'Dictionary.db']);
    shellexecute(0, 'open', 'DownloadDB.exe', Pchar(command), nil, SW_HIDE);
end;


procedure SaveThread.ExecSave(DBDir:string);
begin
  synchronize(SaveProcess(DBDir));
end;

procedure SaveThread.SaveProcess(DBDir: string);
var Cloud: TCloud;
begin
    Cloud:=Tcloud.Create();
    Cloud.SaveToCloud(DBDir);
    Cloud.Free;
end;

end.
